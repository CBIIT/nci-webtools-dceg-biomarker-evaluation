{% extends "layout.html" %}
{% block content %}

<!-- Uses JINJA2 templates. Please do all changes here. Then view the source of the rendered page on the web and copy changes to the root index.html -->
<style>
  li {
		padding-bottom:5px;
  	}
  ul {
      	padding-left:15px;
     }
  ol {
		padding-left:15px;
     }
  h4,h5 {
		padding-top:10px;
  	}
</style>

<div id="blockcontent">
<h3> Age Period Cohort Analysis</h3>
<p>Age-Period-Cohort analysis identifies patterns in cancer incidence or mortality rates from 
population-based <b><i> Count </i></b> (numerator) and <b><i> Population </i></b> (denominator) data. Often the data come 
from a <B>Cancer Registry</B> (e.g., <a href='http://seer.cancer.gov/registries/' target='seer'> SEER</a>) in the form of a table showing the numbers of cancer cases or cancer deaths 
(counts) and corresponding person-years at risk (population) for particular age groups and 
calendar time periods. In cancer research, the Age-Period-Cohort (APC) framework is a fundamental 
model to analyze these data. The APC Model includes <i> parameters </i> that describe the mathematical 
relationships between the <b><i>Rate</i></b> of cancer and attained age, calendar period (year of diagnosis), 
and birth cohort (year of birth). The cancer <b><i>Rate</i></b> is expressed as the number of cancers per 100,000 
persons at risk, which is calculated from the data using the formula: <b><i>(Count/Population) x 100,000.</i></b> </p>

<p>This web tool uses the inputted count and population data to fit the APC Model and returns a number of <b><i>Outputs.</i></b>
To use this tool the width of the age and period intervals must all be equal. When this is so the diagonals 
of the rate table represent birth cohorts.</p> 

<p> Visit the following sections to learn more about the APC web tool:</p>
<ul>
	<li><a href='#started'>Getting started</a> - Learn how to enter data into the tool, get answers to frequently 
	asked questions, and where to go for technical support.</li>
	<li><a href='#example'>Sample data</a> - Enter any of these sample datasets to see the tool in action. </li>
	<li><a href='#whatitdoes'>What it does</a> - Find out what outputs are produced </li>
	<li><a href='#savingyourresults'>Saving your results</a> - Find out how to save raw output as an Excel Workbook, R Workspace, or text file. </li>
        <li><a href='#faq'>FAQ</a> - Find out answers to some common questions about the APC tool.</li>
</ul>
<a name='started'></a><h3>Getting started </h3>
<p>Input data for the web tool consist of <B>Count and Population</B> data for particular age groups over calendar time, in the form of a matrix of rows with paired columns. Rows correspond to particular age groups and columns correspond to calendar time periods. The age and period intervals must all be equal, i.e. if 5-year age groups are used then 5-year calendar periods must also be used. 
The data can be input by copy-and-paste from an Excel worksheet or file upload of a comma-separated-values (csv) file. </p>

<p><h5>To input from Excel:</h5></p>
<ol>
	<li>Copy the paired columns of data you want to analyze from your spreadsheet, 
	right-click inside the empty matrix on the Input tab, and paste your selection.</li>
	<li>Fill in the information (meta-data) on the left hand side of the Input page:
	<ul>
		<li><B>Title</B> - describe your data</li>
		<li><B>Description</B> - add optional details </li>
		<li><B>Start Year</B> - list the first calendar year of the first calendar period of your data, for example, use 1990 for the interval 1990 - 1994</li>
		<li><B>Start Age</B> - list the first age of the first age group of your data, for example use 30 for the interval 30 - 34</li>
		<li><B>Interval (Years)</B> - the width of the age and period intervals, for example use 1 for single-year data, 2 for two-year data, 5 for five-year data (e.g., 1990 - 1994), etc.</li>
	</ul>
	<li>Click the calculate button</li>
	</li>
</ol>
<p><h5>To input data from a csv file:</h5></p>
<p>The csv file can include only count and population data, or it can include information fields in header lines delimited by semicolons, followed by the count and population data. Click <a href='./exampleDataFiles/Holford1983Biometrics.csv' target='_blank'>here</a> to see an example.</p>
<ol>
	<li>Click the Browse button and select your file.</li>
	<li>Add or modify the meta-data on the left hand side of the input page.</li>
	<li>Click the Calculate button.</li>
</ol>

<p><a name="example"></a><h4>Sample data</h4></p>
<p>Illustrative Examples</p>
<p>You can demo the web tool by cutting and pasting the example data into the web tool, then clicking the Calculate button.</p>

<table id="sampledatatable" border="1px">
	<tr>
		<th colspan="2">Sample Data</th>
	</tr>
    <tr>
        <td><B>Title</B> Prostate Cancer Incidence in Nonwhites</td>
        <td rowspan="5" id="datavalues">
        <b>Copy all data below: </b><br /><br />

<pre class='example-data-table'>
177	301000	271	317000	312	353000	382	395000	321	426000	305	473000	308	498000
262	212000	350	248000	552	279000	620	301000	714	358000	649	411000	738	443000
360	159000	479	194000	644	222000	949	222000	932	258000	1292	304000	1327	341000
409	132000	544	144000	812	169000	1150	210000	1668	230000	1958	264000	2153	297000
328	76000	509	94000	763	110000	1097	125000	1593	149000	2039	180000	2433	197000
222	37000	359	47000	584	59000	845	71000	1192	91000	1638	108000	2068	118000
108	19000	178	22000	285	32000	475	39000	742	44000	992	56000	1374	66000
</pre>  
     
        </td>
    </tr>
    <tr>
        <td><B>Description</B><br />   Example from: Holford T.R. The estimation of age, period, and cohort effects for vital rates. Biometrics, 1983; 39:311-324.</td>
    </tr>
    <tr>
        <td><B>Start Year</B> 1935</td>
    </tr>
    <tr>
        <td><B>Start Age</B> 50</td>
    </tr>
    <tr>
        <td><B>Interval</B> 5</td>
    </tr>
    <tr><th colspan='2'> 
    	The csv file is found here: <a style='color:#228;' href='./exampleDataFiles/Holford1983Biometrics.csv' target='_blank'>Prostate Cancer Example File</a>
    </th></tr>
</table>


<table id="sampledatatable" border="1px">
	<tr>
		<th colspan="2">Sample Data</th>
	</tr>	
    <tr>
        <td><B>Title</B> Lung Cancer Mortality in Females from Belgium</td>
        <td rowspan="5" id="datavalues">
        <b>Copy all data below: </b><br /><br />

<pre class='example-data-table'>
3	1578947.368	2	1538461.538	7	1400000	3	1578947.368	10	1428571.429
11	1666666.667	16	1632653.061	11	1527777.778	10	1408450.704	7	1228070.175
11	1410256.41	22	1666666.667	24	1632653.061	25	1524390.244	15	1136363.636
36	1348314.607	44	1392405.063	42	1660079.051	53	1568047.337	48	1221374.046
77	1590909.091	74	1321428.571	68	1379310.345	99	1636363.636	88	1288433.382
106	1606060.606	131	1541176.471	99	1294117.647	142	1340887.63	134	1285988.484
157	1515444.015	184	1533333.333	189	1490536.278	180	1255230.126	177	986072.4234
193	1307588.076	232	1417226.634	262	1455555.556	249	1414772.727	239	999581.765
219	1066731.612	267	1181415.929	323	1297188.755	325	1335799.425	343	1048929.664
223	849847.561	250	902527.0758	308	1010830.325	412	1115322.144	358	930595.269
198	591574.5444	214	636715.2633	253	688060.9192	338	773632.4102	312	690265.4867
</pre>

        </td>
    </tr>
    <tr>
        <td><B>Description</B><br /> Example from: Clayton D. & Schifflers E. Models for temporal variation in cancer rates. I: Age-period and age-cohort models. Stat. Med., 1987; 6:449-467.</td>
    </tr>
    <tr>
        <td><B>Start Year</B> 1955</td>
    </tr>
    <tr>
        <td><B>Start Age</B> 25</td>
    </tr>
    <tr>
        <td><B>Interval</B> 5</td>
    </tr>
    <tr><th colspan='2'> 
    	The csv file is found here: <a style='color:#228;' href='./exampleDataFiles/ClaytonSchifflers1987StatMed.csv' target='_blank'>Lung Cancer Example File</a>
    </th></tr>
</table>
<!-- 
<table id="sampledatatable" border="1px">
	<tr>
		<th colspan="2">Sample Data</th>
	</tr>	
    <tr>
        <td><B>Title</B> Oral Cancer Incidence at HPV-Related Sites in White Males</td>
        <td rowspan="5" id="datavalues">
        <b>Copy all data below: </b><br /><br />
<pre class='example-data-table'>
38	2655844	61	2980012	97	3763370	141	4646871	125	5199589	171	5469588	176	5255913
122	2688338	125	2573983	165	2944425	225	3692897	319	4529835	438	5063539	448	5372024
222	2757647	229	2596258	208	2495095	259	2851472	388	3635290	585	4431466	711	4923580
271	2517854	334	2563881	297	2413126	348	2360030	352	2719212	567	3425859	896	4214559
276	2078337	419	2251967	375	2289385	340	2217312	326	2184372	465	2480478	784	3164494
265	1595444	322	1788748	320	1963592	361	2014472	314	1958011	325	1929117	493	2241725
190	1134899	193	1291607	235	1445855	254	1621767	327	1694793	276	1680346	347	1703767
111	736030	101	843325	159	982036	140	1136567	204	1302277	189	1386461	202	1392328
54	440318	54	469740	71	542595	78	650905	97	786468	116	922927	125	1016946

</pre>

        
        
        </td>
    </tr>
    <tr>
        <td><B>Description</B><br />  SEER 9 Registries Databases, November 2011 Submission. HPV-related sites are base of tongue, lingual tonsil, palatine tonsil, oropharynx, and Waldeyer's ring. ICD-O-3 Topography Codes C019, C024, C090-099, C100-109, and C142.</td>
    </tr>
    <tr>
        <td><B>Start Year</B> 1975</td>
    </tr>
    <tr>
        <td><B>Start Age</B> 40</td>
    </tr>
    <tr>
        <td><B>Interval</B> 5</td>
    </tr>
    <tr><th colspan='2'> 
    	The csv file is found here: <a style='color:#228;' href='./exampleDataFiles/OralCan.csv' target='_blank'>Oral Cancer Example File</a>
    </th></tr>
</table>
-->

<p><a name="whatitdoes"></a><h5>What it does</h5></p>
<p>The web tool applies the APC Model to the data in order to estimate <i>parameters (trends and deviations)</i>. The <i>parameters</i> are combined to produce <i>functions</i> that describe relationships between the observed <b><i>Rate</i></b> of cancer and attained age, calendar period, and birth cohort. The web tool also calculates a number of <i>statistical hypothesis tests (Wald Tests)</i>, which address whether the <b><i>Rate</i></b> of cancer is statistically significantly variable according to age, period, and cohort factors.</p>
<p>The most important functions calculated by the web tool are summarized in the <u><a href="#keyfunctions">Table of Key Functions</a></u> using the following conventions: </p>
<ul>
	<li>The APC model is defined over <i>A</i> age groups and <i>P</i> calendar periods with equal intervals. </li>
	<li>The central age group, calendar period, and birth cohort define standard <B>reference values</B> <i>a</i>, <i>p</i> and <i>c</i>, respectively. </li>
	<li>When there is an even number of age, period, or cohort categories, the reference value is the lower of the two central values.  </li>
	<li>All values labeled <B>CI Lo</B> are lower 95% confidence limits. All values labeled <B>CI Hi</B> are upper 95% confidence limits.</li>
</ul>
<p><a name="keyfunctions"></a><h4>Table of Key Functions</h4></p>
<table id="sampledatatable" class="functions">
	<tr>
		<th>Nomenclature</th>
		<th>Interpretation</th>
	</tr>
	<tr>
		<td>Fitted Temporal Trend</td>
		<td>Expected age-adjusted rates over time</td>
	</tr>
	<tr>
		<td>Net Drift</td>
		<td>Annual percentage change of the expected age-adjusted rates over time</td>
	</tr>
	<tr>
		<td>Local Drifts</td>
		<td>Annual percentage change of the expected age-specific rates over time</td>
	</tr>
	<tr>
		<td>Cross-Sectional Age Curve (Cross Age)</td>
		<td>Expected age-specific rates within a given calendar period</td>
	</tr>
	<tr>
		<td>Longitudinal Age Curve (Long Age)</td>
		<td>Expected age-specific rates for a given number of birth cohorts</td>
	</tr>
	<tr>
		<td>Period Rate Ratios (PeriodRR)</td>
		<td>Ratio of age-specific rates in period relative to reference period  
</td>
	</tr>
	<tr>
		<td>Cohort Rate Ratios (CohortRR)</td>
		<td>Ratio of age-specific rates in cohort relative to reference cohort 
</td>
	</tr>
</table>
<ul>
	<li>Other parameters and functions calculated by the web tool and not listed above are described in greater mathematical detail elsewhere (click <a href="check.html" target="checkLater">here</a> for a PowerPoint presentation).</li>
</ul>
<p>Statistical hypothesis tests calculated by the web tool are summarized in the <u><a href="#hypothesistests">Table of Hypothesis Tests</a>.</u></p>
<p>The <B>Wald Tests</B> follow a Chi-Square distribution when the <B>Null Hypothesis</B> is true.  The <b>df</b> (degrees of freedom) count the number of free parameters included in each test. The web tool reports P-values; values less than 0.05 are often considered 'statistically significant', meaning there is statistical evidence that the <B>Null Hypothesis</B> is unlikely to be correct.</p>

<p><a name="hypothesistests"></a><h4>Table of Hypothesis Tests</h4></p>
<table id="sampledatatable" class="functions">
	<tr>
		<th>Null Hypothesis</th>
		<th>Implications</th>
		<th>Degrees of Freedom</th>
	</tr>
	<tr>
		<td>Net drift = 0</td>
		<td>Fitted temporal trends are stable (i.e., flat with no change) over time. <br />
Fitted longitudinal and cross-sectional age curves are equal.
		</td>
		<td>1
		</td>
	</tr>
	<tr>
		<td>All age deviations = 0</td>
		<td>Fitted longitudinal and cross-sectional age curves are log-linear (i.e., log-additive).</td>
		<td><i>A</i> - 2</td>
	</tr>
	<tr>
		<td>All period deviations = 0</td>
		<td>Fitted temporal trends and period rate ratios are log-linear (i.e., log-additive).</td>
		<td><i>P</i> - 2</td>
	</tr>
	<tr>
		<td>All cohort deviations = 0</td>
		<td>Cohort rate ratios are log-linear; all local drifts equal the net drift.</td>
		<td><i>C</i> - 2</td>
	</tr>
	<tr>
		<td>All period rate ratios = 1</td>
		<td>Net drift is 0 and fitted temporal trends are constant; <br />
Cross-sectional age curve describes age incidence pattern in every period. 
</td>
		<td><i>P</i> - 1</td>
	</tr>
	<tr>
		<td>All cohort rate ratios = 1</td>
		<td>Net drift is 0 and all local drifts are 0; <br />
Longitudinal age curve describes age incidence pattern in every cohort.
</td>
		<td><i>C</i> - 1</td>
	</tr>
	<tr>
		<td>All local drifts = the net drift</td>
		<td>Temporal patterns are the same in every age group.</td>
		<td><i>A</i></td>
	</tr>

</table>
<p>*For APC model defined over <i>A</i> age groups, <i>P</i> calendar periods, and <i>C = P + A - 1</i> birth cohorts.</p>
<h5><a name="savingyourresults"></a>Saving your results</h5>
<p>You can save a complete record of the inputs and outputs using the Download button:</p>
<ul>
  <li>'Text Input' - save the input rates in a separate tab in your web browser. This is a printed version of the inputs in R format.</li>
<li>'Text Output' - save the model outputs in a separate tab in your web browser. This is a printed version of the outputs in R format.</li>
<li>'R-Studio Input' - save the input data in an R Workspace. </li>
<li>'R-Studio Output' - save the model outputs in an R Workspace.</li>
<li>'Excel Output' - save the model outputs in an Excel Workbook. </li>
</ul>
<p><a name="faq"></a><h3>Frequently Asked Questions:</h3></p>
<ul>
<li><i><b>Can my counts include zeroes?</b></i> Yes. The program fills in the zero counts with a small positive value. However, the results may be unreliable or unstable if many counts are zero.</li>
<li><i><b>Can my Populations include zeroes?</b></i> No, zero population counts will generate errors because the corresponding rates are undefined (you can't divide by zero!)</li>
<li><i><b>What algorithm do you use to estimate the parameters and functions?</b></i> We use the statistical method of weighted least squares and the assumption that the count data follow a Poisson distribution allowing for extra-Poisson variation. </li>
<li><i><b>What software do you use?</b></i> Our calculations are carried out using the R environment for statistical computing and graphics.</li>
<li><i><b>Are your R programs available?</b></i> Yes, our R programs are freely available. You can obtain a copy of our code <a href="https://github.com/NCIP/nci-analysis-tools-web-presence/blob/master/src/apc/apcLatest.R" target="code">here</a>.</li>
<li><i><b>How can I use the web tool to analyze data from SEER?</b></i> Click <a href="check.html" target="checkLater">here</a> for details.	</li>
</ul>
</div> <!-- blockcontent -->

{% endblock %}

